Rapport Final d’Analyse Malware

Nom du malware : Res.exe
Environnement : Windows 10 – Machine virtuelle VirtualBox
Type d’analyse : Analyse statique, dynamique et mémoire


1. Contexte et mise en place

Dans le cadre de cette analyse, nous avons créé une machine virtuelle à l’aide de VirtualBox avec le système d’exploitation Windows 10.
Nous avons ensuite téléchargé le malware depuis un dépôt (repository) fourni.
Lors de la première installation du malware sur la machine virtuelle, celle-ci a complètement crashé. Nous avons donc dû :
Réinstaller la machine virtuelle
Augmenter la quantité de RAM allouée
Dès le lancement du malware, nous avons constaté une consommation anormalement élevée des ressources système, notamment de la mémoire vive (RAM).
Une analyse plus approfondie était donc nécessaire.


2. Identification du malware (Hash)
Afin de savoir si ce malware était déjà connu, nous avons commencé par calculer son hash SHA256.
Commande utilisée :
Get-FileHash -Algorithm SHA256 "C:\Users\theol\Desktop\VIRUS\Res.exe"
Résultat :
49F091ADE48890BFA22D2B455494BE95E52392C478B67E10626222B6AEE37E1E
Ce hash a ensuite été soumis sur VirusTotal.
Résultat VirusTotal :

Malware inconnu (aucune signature détectée)

Cela indique que le malware est soit :

  - Très récent

  - Peu répandu

  - Ou volontairement modifié (obfuscation)


3. Analyse statique avec PeStudio

Nous avons utilisé PeStudio pour effectuer une première analyse statique du binaire.
Résultats principaux :

Score de détection : 52/72
Indications : Spyware, Keylogger, Trojan
Fonctions suspectes importées :
GetCurrentProcess
VirtualProtect
GetCurrentProcessId
GetCurrentThread
VirtualQuery
GetAsyncKeyState
GetKeyState

Ces fonctions sont typiques de :

Surveillance du clavier
Injection mémoire
Évasion de détection
Analyse du comportement utilisateur


4. Analyse dynamique – Comportement du malware

Grâce à Process Hacker et Process Explorer, nous avons observé le comportement réel du malware.
Création de fichiers et dossiers
Le malware crée un dossier :
C:\WindSyst

Chaîne détectée :

mkdir C:\WindSyst

Il y copie ensuite plusieurs fichiers :
DLL :
  - libgcc_s_dw2-1.dll
  - libstdc++-6.dll
  - Qt5Core.dll
  - Qt5Gui.dll
  - Qt5Widgets.dll
  - Qt5Network.dll

Exécutables :

Res.exe
Env.exe
xcopy.exe

Persistance

Le malware s’installe en démarrage automatique via la clé de registre :
HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run

Ce mécanisme permet au malware de se relancer à chaque démarrage de session.


5. Utilisation de Qt

Le malware utilise massivement le framework Qt :
Qt5Core
Qt5Gui
Qt5Widgets
Qt5Network

Plateformes :
qwindows.dll
qoffscreen.dll
qminimal.dll

Cela indique que le malware :
Dispose d’une interface graphique
Peut fonctionner en mode invisible (headless)
Possède probablement des communications réseau


6. Fichier suspect

Le malware interagit avec :
C:\WindSyst\logo.txt

Ce fichier peut servir à :
Stocker une configuration
Enregistrer des logs
Contenir des instructions ou données exfiltrées


7. Autres capacités suspectes

Nous avons également détecté :
Utilisation de fonctions de hash (SHA256)
Accès potentiel aux périphériques audio (micro)
Surveillance clavier (keylogger)


8. Analyse mémoire (Dump RAM)
Outils utilisés :
DumpIt
Volatility
PIP (Python)

Procédure :
Installation de DumpIt
Lancement depuis PowerShell :
DumpIt.exe

Génération du dump mémoire

Installation de Volatility

Commande de vérification :
vol -h

Analyse des processus :
vol -f "dump.raw" windows.pslist

Cela nous a permis d’identifier les processus suspects actifs en mémoire.


9. Analyse USB (Forensique)
Commande utilisée :
strings SYSTEM | grep -i usbstor -A 5

Résultat :
USBSTOR\Disk&Ven_SanDisk&Prod_Cruzer_Blade&Rev_1.00\4C530000281008116284&0

Outils forensiques :
FTK Imager
Registry Explorer

Fichiers analysés :
SYSTEM
SOFTWARE
NTUSER.DAT


10. Chronologie des événements
Date	Événement
2026-01-20 14:32	Installation initiale de la clé USB
2026-01-21	Activité utilisateur
2026-01-22 07:59	Dernière connexion USB
2026-01-22 09:15	Dump mémoire réalisé



11. Conclusion

Le malware Res.exe est un malware avancé et furtif, présentant les caractéristiques suivantes :
Capacités principales :

Persistance via registre

Création de fichiers système cachés

Surveillance clavier (keylogger)

Potentiel espionnage audio

Communication réseau

Injection mémoire

Évasion d’analyse

Type de malware probable :

Trojan spyware / backdoor avec capacités de keylogging

Gravité :

Élevée

Ce malware permet :

La surveillance de l’utilisateur

La récupération de données sensibles

Une persistance durable sur la machine

Une potentielle exfiltration de données

12. Recommandations

Ne jamais exécuter ce malware sur une machine réelle

Toujours utiliser une VM isolée

Bloquer les communications réseau

Supprimer les clés de registre après analyse

Restaurer la VM après chaque test

Conclusion finale :
Res.exe est un malware inconnu mais hautement malveillant, combinant des techniques modernes d’espionnage, de persistance et d’évasion, ce qui en fait une menace sérieuse.
